{% extends "geonode_geodash/base.html" %}

{% load geodash_tags %}

{% block title %}{{ map_config.title }}{% endblock %}

{% block head_fonts %}
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic' rel='stylesheet' type='text/css'>
{% endblock %}

{% block head_bootstrap_css %}
<link href="{{ STATIC_URL }}geonode_geodash/build/bootstrap/bootstrap.css" rel="stylesheet"/>
{% endblock %}

{% block head_main_css %}
<link href='{{ STATIC_URL }}geonode_geodash/build/css/geonodegeodash.css?v={{ GEODASH_STATIC_VERSION }}' rel='stylesheet' />
{% endblock %}

{% block head_monolith_css %}
<link href='{{ STATIC_URL }}geonode_geodash/build/css/geonodegeodash.full.css?v={{ GEODASH_STATIC_VERSION }}' rel='stylesheet' />
{% endblock %}

{% block polyfill %}
{% if GEODASH_STATIC_DEPS.polyfill %}
<script src="{{ STATIC_URL }}geonode_geodash/build/js/polyfill.js?v={{ GEODASH_STATIC_VERSION }}"></script>
{% else %}
<script src="{{ STATIC_URL }}geonode_geodash/build/js/polyfill.min.js?v={{ GEODASH_STATIC_VERSION }}"></script>
{% endif %}
{% endblock %}

{% block head_main_js %}
<script src="{{ STATIC_URL }}geodash/lib/showdown/1.3.0/showdown.js?v={{ GEODASH_STATIC_VERSION }}"></script>
{% if GEODASH_STATIC_DEBUG.main %}
<script src="{{ STATIC_URL }}geonode_geodash/build/js/monkeypatch.js?v={{ GEODASH_STATIC_VERSION }}"></script>
<script src="{{ STATIC_URL }}geonode_geodash/build/js/geonodegeodash.js?v={{ GEODASH_STATIC_VERSION }}"></script>
{% else %}
<script src="{{ STATIC_URL }}geonode_geodash/build/js/monkeypatch.min.js?v={{ GEODASH_STATIC_VERSION }}"></script>
<script src="{{ STATIC_URL }}geonode_geodash/build/js/geonodegeodash.min.js?v={{ GEODASH_STATIC_VERSION }}"></script>
{% endif %}
{% endblock %}

{% block head_monolith_js %}
{% if GEODASH_STATIC_DEBUG.monolith %}
<script src="{{ STATIC_URL }}geonode_geodash/build/js/geonodegeodash.full.js?v={{ GEODASH_STATIC_VERSION }}"></script>
{% else %}
<script src="{{ STATIC_URL }}geonode_geodash/build/js/geonodegeodash.full.min.js?v={{ GEODASH_STATIC_VERSION }}"></script>
{% endif %}
{% endblock %}

{% block head_inline %}
{% include "geodash/_includes/snippet_const.html" %}
{% endblock %}

{% block extra_head %}
  {% block map_config %}
  <script type="text/javascript" language="Javascript">
    geodash.map_config = {{ map_config_json|safe }};
  </script>
  {% endblock %}
  {% block initial_state %}
  <script>
    geodash.initial_state = {{ state_json|safe }};
    geodash.state_schema = {{ state_schema_json|safe }};
    {% if perms_json %}
    geodash.perms = {{ perms_json|safe }};
    {% endif %}
  </script>
  {% endblock %}
  {% block initial_data %}
  <script type="text/javascript" language="Javascript">
      geodash.initial_data = {"data":{}};
  </script>
  {% endblock %}
{% endblock %}

{% block init %}
<script type="text/javascript" language="Javascript">
  $(function(){
    geodash.{{ init_function | default_if_none:"init_explore" }}(
      "mainApp",
      $("#{{ geodash_main_id | default_if_none:'geodash-main' }}")
    );
  });
</script>
{% endblock %}

{% block content %}
<div class="container-fluid">
    {% block header %}{% include "geonode_geodash/_includes/header.html" with navbar_title="Dashboards" %}{% endblock %}
    <div
      id="geodash-main"
      class="row geodash-row geodash-main geodash-controller"
      ng-controller="geodash-main"
      geodash-controller="geodash-main">
      {% block sidebar_left %}{% endblock %}
      <div
        id="geodash-map"
        class="row geodash-row geodash-map geodash-controller{% if include_sidebar_left %} sidebar-open sidebar-left-open{% endif %}{% if include_sidebar_right %} sidebar-open sidebar-right-open{% endif %}"
        ng-controller="geodash-map"
        geodash-controller="geodash-map">
        {% block map_controllers %}
        {% include "geodash/_includes/map_overlays.html" %}
        {% include "geodash/_includes/map_legend.html" with legend_title="Legend - Click to Open" %}
        {% endblock %}
        <div id="map"
          class="geodash-controller geodash-map-map"
          ng-controller="geodash-map-map"
          geodash-controller="geodash-map-map">
        </div>
      </div>
      {% block sidebar_right %}
      {% if include_sidebar_right %}
      <div
        id="geodash-sidebar-right"
        class="geodash-sidebar geodash-sidebar-right geodash-controller sidebar-open sidebar-right-open"
        style="overflow-x: hidden; overflow-y: scroll;"
        ng-controller="geodash-sidebar-right">
        <div geodash-dashboard-editor></div>
        <div class="geodash-sidebar-right-modals">
          <div
            id="geodash-modal-edit-object"
            class="geodash-controller geodash-controller-modal geodash-modal modal fade geodash-edit-object"
            tabindex="-1"
            role="dialog"
            aria-labelledby="myModalLabel"
            geodash-modal-edit-object>
          </div>
          <div
            id="geodash-modal-edit-field"
            class="geodash-controller geodash-controller-modal geodash-modal modal fade geodash-edit-field"
            tabindex="-1"
            role="dialog"
            aria-labelledby="myModalLabel"
            geodash-modal-edit-field>
          </div>
        </div>
      </div>
      {% endif %}
      {% endblock %}
      <div id="geodash-modals">
      {% block modals %}
      {% include "geodash/_includes/modals/about.html" %}
      {% include "geodash/_includes/modals/download.html" %}
      {% endblock %}
      </div>
    </div>
    {% block footer %}{% endblock %}
</div>
{% block extra_content %}{% endblock %}
{% endblock %}
